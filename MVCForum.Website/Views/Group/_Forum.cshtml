@using MvcForum.Core.Models.Enums
@model MvcForum.Web.ViewModels.Group.GroupTopicsViewModel
@{

}
<div>
	<h2>@Html.LanguageString("Group.Forum")</h2>


	@if ((Model.LoggedInUserRole == null && !Model.PublicGroup) || (Model.GroupUserStatus != GroupUserStatus.Joined && Model.LoggedInUserRole != null && Model.LoggedInUserRole.RoleName != Constants.AdminRoleName && !Model.PublicGroup))
	{
		<p>@Html.LanguageString("Group.PermissionDenied")</p>
	}

	else if (Model.GroupUserStatus == GroupUserStatus.Joined || Model.PublicGroup || Model.LoggedInUserRole?.RoleName == Constants.AdminRoleName)
	{
		if (User.Identity.IsAuthenticated)
		{
			@Html.Action("CreateTopicButton", "Topic", new{groupId = Model.GroupId})
		}

		if (Model.TotalCount > 0)
		{
			foreach (var topic in Model.Topics)
			{
				Html.RenderPartial("_Topic", topic);
			}

			if (Model.TotalPages > 1)
			{
				@Html.Pager(Convert.ToInt32(Model.PageIndex), Html.Settings().TopicsPerPage, Model.TopicCount, null)
			}

		}
		else if (Model.TotalCount == 0)
		{
			<p>@Html.LanguageString("Group.NoDiscussions")</p>
		}
	}
	
</div>